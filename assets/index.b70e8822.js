var le=Object.defineProperty,de=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var Q=(e,t,i)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,V=(e,t)=>{for(var i in t||(t={}))ue.call(t,i)&&Q(e,i,t[i]);if(K)for(var i of K(t))he.call(t,i)&&Q(e,i,t[i]);return e},M=(e,t)=>de(e,fe(t));import{o as u,c as p,a as o,r as Y,b as Z,n as A,p as H,d as S,e as x,t as B,f as m,w as y,g as D,h as O,F as w,i as b,j as E,k as q,l as z,m as ce,q as k,s as pe,u as ye}from"./vendor.2eebf196.js";const ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}};ge();var _=(e,t)=>{const i=e.__vccOpts||e;for(const[d,n]of t)i[d]=n;return i};const me={},ve={class:"layout"},ke={class:"header"},_e=Z("HEADER"),xe={class:"sidebar"},Ce=Z("SIDEBAR"),we={class:"main"},be=Z("MAIN");function He(e,t){return u(),p("div",ve,[o("div",ke,[Y(e.$slots,"header",{},()=>[_e],!0)]),o("div",xe,[Y(e.$slots,"sidebar",{},()=>[Ce],!0)]),o("div",we,[Y(e.$slots,"default",{},()=>[be],!0)])])}var Se=_(me,[["render",He],["__scopeId","data-v-509300c4"]]),Ve="/card-dragger/assets/flash.5f261017.svg",Me="/card-dragger/assets/delay.649039da.svg",Ae="/card-dragger/assets/email.2b9a3eee.svg",De="/card-dragger/assets/fork.658de95f.svg",Le="/card-dragger/assets/account.0e220282.svg",Pe="/card-dragger/assets/run.2febf3be.svg",Ie="/card-dragger/assets/headset.2d574690.svg";const Oe={props:["fromX","fromY","toX","toY","stroke"],computed:{padding(){return this.stroke*2},left(){return(this.fromX<this.toX?this.fromX:this.toX)-this.padding},top(){return(this.fromY<this.toY?this.fromY:this.toY)-this.padding},width(){return Math.abs(this.fromX-this.toX)+this.padding*2},height(){return Math.abs(this.fromY-this.toY)+this.padding*2},viewBox(){return`0 0 ${this.width} ${this.height}`},x1(){return this.fromX<this.toX?this.padding:this.width-this.padding},y1(){return this.fromY<this.toY?this.padding:this.height-this.padding},x2(){return this.fromX<this.toX?this.width-this.padding:this.padding},y2(){return this.fromY<this.toY?this.height-this.padding:this.padding},style(){return{position:"absolute",left:`${this.left}px`,top:`${this.top}px`,zIndex:10}}}},Xe=e=>(H("data-v-73f9b1fb"),e=e(),S(),e),Ye=["width","height","viewBox"],Be=["x1","y1","x2","y2","stroke-width"],ze=["cx","cy","r"],Te=Xe(()=>o("marker",{id:"triangle",viewBox:"0 0 10 10",refX:"10",refY:"5",markerUnits:"strokeWidth",markerHeight:"4",orient:"auto",stroke:"#0093ff",fill:"#0093ff"},[o("path",{d:"M 0 0 L 10 5 L 0 10 z"})],-1)),Ze=["cx","cy","r"];function Ee(e,t,i,d,n,r){return u(),p("svg",{xmlns:"http://www.w3.org/2000/svg",class:"connector",width:r.width,height:r.height,viewBox:r.viewBox,style:A(r.style)},[o("line",{x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,stroke:"#0093ff","stroke-width":i.stroke,"marker-end":"url(#triangle)"},null,8,Be),o("circle",{cx:r.x1,cy:r.y1,r:i.stroke,stroke:"#0093ff",fill:"white","stroke-width":"2"},null,8,ze),Te,o("circle",{cx:r.x2,cy:r.y2,r:i.stroke,stroke:"#0093ff",fill:"white","stroke-width":"2"},null,8,Ze)],12,Ye)}var je=_(Oe,[["render",Ee],["__scopeId","data-v-73f9b1fb"]]);const Ne={components:{LineConnector:je},props:{id:{type:[String,Number]},parent:{type:[String,Number]},type:{type:String,validator(e){return["flash","delay","email","fork","account","run","headset","stop","stop-left","stop-right"].includes(e)}},text:{type:String},x:{type:[String,Number]},y:{type:[String,Number]},width:{type:[String,Number]},height:{type:[String,Number]},leftConnection:{type:Object},rightConnection:{type:Object},absolute:{type:Boolean,default:!1},rejected:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0}},data(){return{dragOver:!1}},emits:["dropOn","dragStart","click"],computed:{icons(){return{flash:Ve,delay:Me,email:Ae,fork:De,run:Pe,headset:Ie,account:Le}},nodeStyle(){if(this.absolute)return{position:"absolute",left:`${this.x}px`,top:`${this.y}px`,width:`${this.width}px`,height:`${this.height}px`}},isFork(){return this.type==="fork"},children(){return[this.leftConnection,this.rightConnection].filter(Boolean)},bothChildren(){return this.children.length===2},singleChild(){return this.children.length===1},centralConnectionPoint(){return{x:this.x+this.width/2,y:this.y+this.height}},leftConnectionPoint(){return{x:this.x,y:this.y+this.height/2}},rightConnectionPoint(){return{x:this.x+this.width,y:this.y+this.height/2}},singleChildConnection(){if(this.leftConnection)return this.leftConnection;if(this.rightConnection)return this.rightConnection}},methods:{startDrag(e){e.dataTransfer.setData("id",this.id),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",this.$emit("dragStart",{from:this.id})},dragend(){this.dragOver=!1},dragenter(){this.dragOver=!0},dragleave(){this.dragOver=!1},drop(e){this.dragOver=!1;const t=e.dataTransfer.getData("id"),i=this.id;this.$emit("dropOn",{from:t,to:i})},click(){this.$emit("click",this.id)}}},Je=["draggable"],We={class:"icon"},Ue=["src"],Ge={class:"content"},Re={class:"desc"},Fe=["innerHTML"];function Ke(e,t,i,d,n,r){const l=x("LineConnector");return u(),p(w,null,[o("div",{class:m(["generic-node",{"drag-over":n.dragOver,rejected:i.rejected}]),style:A(r.nodeStyle),draggable:i.draggable,onDragstart:t[0]||(t[0]=(...a)=>r.startDrag&&r.startDrag(...a)),onDragend:t[1]||(t[1]=(...a)=>e.dragEnd&&e.dragEnd(...a)),onDragover:t[2]||(t[2]=y(()=>{},["prevent"])),onDragenter:t[3]||(t[3]=y((...a)=>r.dragenter&&r.dragenter(...a),["prevent"])),onDragleave:t[4]||(t[4]=y((...a)=>r.dragleave&&r.dragleave(...a),["prevent"])),onDrop:t[5]||(t[5]=y((...a)=>r.drop&&r.drop(...a),["stop"])),onClick:t[6]||(t[6]=y((...a)=>r.click&&r.click(...a),["stop"])),onMousedown:t[7]||(t[7]=y(()=>{},["stop"]))},[o("div",We,[o("img",{src:r.icons[i.type]},null,8,Ue)]),o("div",Ge,[o("div",Re,B(i.type.toUpperCase()),1),o("div",{class:"text",innerHTML:i.text},null,8,Fe)])],46,Je),r.singleChild?(u(),D(l,{key:0,fromX:r.centralConnectionPoint.x,fromY:r.centralConnectionPoint.y,toX:r.singleChildConnection.x,toY:r.singleChildConnection.y,stroke:"4"},null,8,["fromX","fromY","toX","toY"])):O("",!0)],64)}var X=_(Ne,[["render",Ke]]);const Qe={components:{BaseNode:X},props:{node:{type:Object,requiered:!0},nodes:{type:Array,requiered:!0}},data(){return{currentTab:0,left:!0}},watch:{node(e,t){e.id!==t.id&&(this.currentTab=0,this.left=!0)}},methods:{addNode(e){this.$emit("add",e,this.left)},updateNodeText({target:{value:e}}){this.$emit("update",this.node.id,M(V({},this.node),{text:e}))}}},L=e=>(H("data-v-65f6a08c"),e=e(),S(),e),qe={class:"node-viewer"},$e=L(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"})],-1)),et=[$e],tt={class:"tabs"},rt={class:"panels"},it={class:"form-group"},nt=L(()=>o("label",null,"Enter text:",-1)),st=["value"],ot=q('<svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M22,21H2V3H4V19H6V17H10V19H12V16H16V19H18V17H22V21M18,14H22V16H18V14M12,6H16V9H12V6M16,15H12V10H16V15M6,10H10V12H6V10M10,16H6V13H10V16Z" data-v-65f6a08c></path></svg><svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M11,2V22C5.9,21.5 2,17.2 2,12C2,6.8 5.9,2.5 11,2M13,2V11H22C21.5,6.2 17.8,2.5 13,2M13,13V22C17.7,21.5 21.5,17.8 22,13H13Z" data-v-65f6a08c></path></svg><svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M4,5H20V7H4V5M4,9H20V11H4V9M4,13H20V15H4V13M4,17H14V19H4V17Z" data-v-65f6a08c></path></svg><svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M4,3H20A2,2 0 0,1 22,5V20A2,2 0 0,1 20,22H4A2,2 0 0,1 2,20V5A2,2 0 0,1 4,3M4,7V10H8V7H4M10,7V10H14V7H10M20,10V7H16V10H20M4,12V15H8V12H4M4,20H8V17H4V20M10,12V15H14V12H10M10,20H14V17H10V20M20,20V17H16V20H20M20,12H16V15H20V12Z" data-v-65f6a08c></path></svg>',4),at=[ot],lt=q('<div style="display:flex;flex-direction:column;align-items:center;" data-v-65f6a08c><svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M21,3H3C2,3 1,4 1,5V19A2,2 0 0,0 3,21H21C22,21 23,20 23,19V5C23,4 22,3 21,3M5,17L8.5,12.5L11,15.5L14.5,11L19,17H5Z" data-v-65f6a08c></path></svg><svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M22 13H14V11H22V13M22 7H14V9H22V7M14 17H22V15H14V17M12 9V15C12 16.1 11.1 17 10 17H4C2.9 17 2 16.1 2 15V9C2 7.9 2.9 7 4 7H10C11.1 7 12 7.9 12 9M10.5 15L8.3 12L6.5 14.3L5.3 12.8L3.5 15H10.5Z" data-v-65f6a08c></path></svg><svg style="width:96px;height:96px;" viewBox="0 0 24 24" data-v-65f6a08c><path fill="currentColor" d="M4,5H20V7H4V5M4,9H20V11H4V9M4,13H20V15H4V13M4,17H14V19H4V17Z" data-v-65f6a08c></path></svg></div>',1),dt=[lt],ft=L(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),ut=L(()=>o("b",null,"Add card below",-1)),ht={key:0,class:"tabs centered"},ct=L(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24",tooltip:"To the left side"},[o("path",{fill:"currentColor",d:"M11,9L12.42,10.42L8.83,14H18V4H20V16H8.83L12.42,19.58L11,21L5,15L11,9Z"})],-1)),pt=[ct],yt=L(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24",tooltip:"To the right side"},[o("path",{fill:"currentColor",d:"M19,15L13,21L11.58,19.58L15.17,16H4V4H6V14H15.17L11.58,10.42L13,9L19,15Z"})],-1)),gt=[yt],mt={class:"container"},vt=L(()=>o("b",null,"Delete node",-1)),kt=[vt];function _t(e,t,i,d,n,r){const l=x("BaseNode");return u(),p("div",qe,[o("div",{class:"close-control",onClick:t[0]||(t[0]=a=>e.$emit("close"))},et),b(l,{id:i.node.id,draggable:!1,type:i.node.type},null,8,["id","type"]),o("div",tt,[o("div",{class:m(["tab",{current:n.currentTab===0}]),onClick:t[1]||(t[1]=a=>n.currentTab=0)}," Edit ",2),o("div",{class:m(["tab",{current:n.currentTab===1}]),onClick:t[2]||(t[2]=a=>n.currentTab=1)}," Stats ",2),i.node.type==="email"?(u(),p("div",{key:0,class:m(["tab",{current:n.currentTab===2}]),onClick:t[3]||(t[3]=a=>n.currentTab=2)}," Preview ",2)):O("",!0)]),o("div",rt,[o("div",{class:m(["tab",{current:n.currentTab===0}])},[o("div",it,[nt,o("input",{value:i.node.text,onChange:t[4]||(t[4]=(...a)=>r.updateNodeText&&r.updateNodeText(...a))},null,40,st)])],2),o("div",{class:m(["tab",{current:n.currentTab===1}])},at,2),o("div",{class:m(["tab",{current:n.currentTab===2}])},dt,2)]),ft,ut,i.node.type==="fork"?(u(),p("div",ht,[o("div",{class:m(["tab",{current:n.left}]),onClick:t[5]||(t[5]=a=>n.left=!0)},pt,2),o("div",{class:m(["tab",{current:!n.left}]),onClick:t[6]||(t[6]=a=>n.left=!1)},gt,2)])):O("",!0),(u(!0),p(w,null,E(i.nodes,a=>(u(),p("div",{class:"container",key:a.type},[b(l,{id:a.id,type:a.type,draggable:!1,onClick:c=>r.addNode(a.id)},null,8,["id","type","onClick"])]))),128)),o("div",mt,[o("button",{class:"generic-node",onClick:t[7]||(t[7]=a=>e.$emit("delete",i.node.id))},kt)])])}var xt=_(Qe,[["render",_t],["__scopeId","data-v-65f6a08c"]]);const Ct={props:{width:{type:[String,Number]},height:{type:[String,Number]},rejected:{type:Boolean,default:!1}},data(){return{dragOver:!1}},emits:["delete"],computed:{nodeStyle(){if(this.absolute)return{width:`${this.width}px`,height:`${this.height}px`}}},methods:{dragend(){this.dragOver=!1},dragenter(){this.dragOver=!0},dragleave(){this.dragOver=!1},drop(e){this.dragOver=!1;const t=e.dataTransfer.getData("id");this.$emit("delete",t)}}},wt=e=>(H("data-v-3ac271d6"),e=e(),S(),e),bt=wt(()=>o("svg",{style:{width:"96px",height:"96px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1)),Ht=[bt];function St(e,t,i,d,n,r){return u(),p("div",{class:m(["trash",{"drag-over":n.dragOver,rejected:i.rejected}]),onDragend:t[0]||(t[0]=(...l)=>r.dragend&&r.dragend(...l)),onDragover:t[1]||(t[1]=y(()=>{},["prevent"])),onDragenter:t[2]||(t[2]=y((...l)=>r.dragenter&&r.dragenter(...l),["prevent"])),onDragleave:t[3]||(t[3]=y((...l)=>r.dragleave&&r.dragleave(...l),["prevent"])),onDrop:t[4]||(t[4]=y((...l)=>r.drop&&r.drop(...l),["stop"]))},Ht,34)}var Vt=_(Ct,[["render",St],["__scopeId","data-v-3ac271d6"]]);const Mt={components:{BaseNode:X,Trash:Vt,BlockViewer:xt},props:{nodes:{type:Array,required:!0},rejected:{type:Object,required:!0},selected:{type:Object}},methods:{onDelete(e){const t=e.dataTransfer.getData("id");this.$emit("delete",t)},addNode(e,t){this.$emit("add",e,t)},updateNode(e,t){this.$emit("update",e,t)}}},$=e=>(H("data-v-7ae44ddb"),e=e(),S(),e),At={class:"sidebar"},Dt=$(()=>o("b",null,"Drag and drop cards",-1)),Lt=$(()=>o("div",{class:"separator"},null,-1));function Pt(e,t,i,d,n,r){const l=x("BlockViewer"),a=x("BaseNode"),c=x("Trash");return u(),p("div",At,[i.selected?(u(),D(l,{key:0,node:i.selected,nodes:i.nodes,onDelete:t[0]||(t[0]=v=>e.$emit("delete",v)),onAdd:r.addNode,onUpdate:r.updateNode,onClose:t[1]||(t[1]=v=>e.$emit("unselect"))},null,8,["node","nodes","onAdd","onUpdate"])):(u(),p(w,{key:1},[Dt,(u(!0),p(w,null,E(i.nodes,v=>(u(),p("div",{class:"container",key:v.type},[b(a,{rejected:Boolean(i.rejected[v.id]),id:v.id,type:v.type},null,8,["rejected","id","type"])]))),128)),Lt,b(c,{rejected:i.rejected.trash,onDrop:r.onDelete},null,8,["rejected","onDrop"])],64))])}var It=_(Mt,[["render",Pt],["__scopeId","data-v-7ae44ddb"]]);const Ot={data(){return{active:!1}}},Xt=e=>(H("data-v-313ad578"),e=e(),S(),e),Yt={class:"label"},Bt=Xt(()=>o("path",{fill:"currentColor",d:"M7,15L12,10L17,15H7Z"},null,-1)),zt=[Bt];function Tt(e,t,i,d,n,r){return u(),p("div",{class:m(["drop-down",{active:n.active}]),onClick:t[0]||(t[0]=l=>n.active=!n.active)},[o("div",{class:m(["header",{active:n.active}])},[o("div",Yt,[Y(e.$slots,"label",{},void 0,!0)]),(u(),p("svg",{class:m(["caret",{active:n.active}]),style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},zt,2))],2),o("div",{class:m(["dropdown",{active:n.active}])},[Y(e.$slots,"dropdown",{},void 0,!0)],2)],2)}var Zt=_(Ot,[["render",Tt],["__scopeId","data-v-313ad578"]]);const Et={components:{DropDown:Zt},props:{undoable:{type:Boolean},redoable:{type:Boolean},samples:{type:Array,required:!0},status:{type:String}},methods:{undo(){this.$emit("undo")},redo(){this.$emit("redo")},zoomIn(){this.$emit("zoomIn")},zoomOut(){this.$emit("zoomOut")}}},P=e=>(H("data-v-6b173fdc"),e=e(),S(),e),jt=P(()=>o("h1",null,"Flow composer",-1)),Nt=P(()=>o("div",{class:"separator"},null,-1)),Jt=Z(" Create workflow "),Wt=P(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})],-1)),Ut=P(()=>o("span",{class:"label"},"Empty workflow",-1)),Gt=[Wt,Ut],Rt=["onClick"],Ft=P(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M12 1A2.5 2.5 0 0 0 9.5 3.5A2.5 2.5 0 0 0 11 5.79V7H7A2 2 0 0 0 5 9V9.71A2.5 2.5 0 0 0 3.5 12A2.5 2.5 0 0 0 5 14.29V15H4A2 2 0 0 0 2 17V18.21A2.5 2.5 0 0 0 .5 20.5A2.5 2.5 0 0 0 3 23A2.5 2.5 0 0 0 5.5 20.5A2.5 2.5 0 0 0 4 18.21V17H8V18.21A2.5 2.5 0 0 0 6.5 20.5A2.5 2.5 0 0 0 9 23A2.5 2.5 0 0 0 11.5 20.5A2.5 2.5 0 0 0 10 18.21V17A2 2 0 0 0 8 15H7V14.29A2.5 2.5 0 0 0 8.5 12A2.5 2.5 0 0 0 7 9.71V9H17V9.71A2.5 2.5 0 0 0 15.5 12A2.5 2.5 0 0 0 17 14.29V15H16A2 2 0 0 0 14 17V18.21A2.5 2.5 0 0 0 12.5 20.5A2.5 2.5 0 0 0 15 23A2.5 2.5 0 0 0 17.5 20.5A2.5 2.5 0 0 0 16 18.21V17H20V18.21A2.5 2.5 0 0 0 18.5 20.5A2.5 2.5 0 0 0 21 23A2.5 2.5 0 0 0 23.5 20.5A2.5 2.5 0 0 0 22 18.21V17A2 2 0 0 0 20 15H19V14.29A2.5 2.5 0 0 0 20.5 12A2.5 2.5 0 0 0 19 9.71V9A2 2 0 0 0 17 7H13V5.79A2.5 2.5 0 0 0 14.5 3.5A2.5 2.5 0 0 0 12 1M12 2.5A1 1 0 0 1 13 3.5A1 1 0 0 1 12 4.5A1 1 0 0 1 11 3.5A1 1 0 0 1 12 2.5M6 11A1 1 0 0 1 7 12A1 1 0 0 1 6 13A1 1 0 0 1 5 12A1 1 0 0 1 6 11M18 11A1 1 0 0 1 19 12A1 1 0 0 1 18 13A1 1 0 0 1 17 12A1 1 0 0 1 18 11M3 19.5A1 1 0 0 1 4 20.5A1 1 0 0 1 3 21.5A1 1 0 0 1 2 20.5A1 1 0 0 1 3 19.5M9 19.5A1 1 0 0 1 10 20.5A1 1 0 0 1 9 21.5A1 1 0 0 1 8 20.5A1 1 0 0 1 9 19.5M15 19.5A1 1 0 0 1 16 20.5A1 1 0 0 1 15 21.5A1 1 0 0 1 14 20.5A1 1 0 0 1 15 19.5M21 19.5A1 1 0 0 1 22 20.5A1 1 0 0 1 21 21.5A1 1 0 0 1 20 20.5A1 1 0 0 1 21 19.5Z"})],-1)),Kt={class:"label"},Qt=["disabled"],qt=["disabled"],$t=P(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})],-1)),er=[$t],tr=["disabled"],rr=P(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"})],-1)),ir=[rr],nr=["textContent"];function sr(e,t,i,d,n,r){const l=x("DropDown");return u(),p("header",null,[jt,Nt,b(l,{class:"mx-1"},{label:z(()=>[Jt]),dropdown:z(()=>[o("div",{class:"dropdown-item",onClick:t[0]||(t[0]=a=>e.$emit("erase"))},Gt),(u(!0),p(w,null,E(i.samples,a=>(u(),p("div",{class:"dropdown-item",key:a.id,onClick:c=>e.$emit("select",a.id)},[Ft,o("span",Kt,B(a.name),1)],8,Rt))),128))]),_:1}),o("label",{class:"primary-text",onClick:t[1]||(t[1]=(...a)=>r.undo&&r.undo(...a)),disabled:!i.undoable},"Undo/redo",8,Qt),o("button",{class:"primary-text",onClick:t[2]||(t[2]=(...a)=>r.undo&&r.undo(...a)),disabled:!i.undoable},er,8,qt),o("button",{class:"primary-text",onClick:t[3]||(t[3]=(...a)=>r.redo&&r.redo(...a)),disabled:!i.redoable},ir,8,tr),o("label",{textContent:B(i.status),class:"mx-1 indicator"},null,8,nr)])}var or=_(Et,[["render",sr],["__scopeId","data-v-6b173fdc"]]);function ar(e,t,i=!1){const d=2,n=e[t],r=s=>e[s],l=(s,f)=>{f(s),s.left&&l(r(s.left),f),s.right&&l(r(s.right),f)},a=(s,f)=>{s.left&&l(r(s.left),f),s.right&&l(r(s.right),f),f(s)},c=(s,f,g)=>{s.y=f,s.x=0,s.final=0,s.modifier=0,s.prevSibling=g,s.left&&c(r(s.left),f+1,null),s.right&&c(r(s.right),f+1,s.left||null)},v=s=>{s.left&&v(r(s.left)),s.right&&v(r(s.right)),s.prevSibling?s.x=s.x+r(s.prevSibling).x+d:s.x=0,s.left&&s.right?s.modifier=s.x-Math.ceil((r(s.right).x+r(s.left).x)/2):(s.left||s.right)&&(s.modifier=s.x)},I=(s,f)=>{s.final=s.x+f,s.left&&I(r(s.left),s.modifier+f),s.right&&I(r(s.right),s.modifier+f)},N=s=>{const f={};let g=0;return l(s,h=>{f[h.y]||(f[h.y]={}),f[h.y][h.final]&&g++,f[h.y][h.final]=1}),g},J=s=>{const f={};let g=0;return a(s,h=>{f[h.y]||(f[h.y]={});const G=f[h.y-1]&&f[h.y-1][h.final];G&&G.left!==h.id&&G.right!==h.id&&g++;const R=f[h.y+1]&&f[h.y+1][h.final];R&&R.left!==h.id&&R.right!==h.id&&g++,f[h.y][h.final]=h}),g},W=s=>{s.left&&W(r(s.left)),s.right&&W(r(s.right));let f=-1/0;s.left&&l(r(s.left),h=>{f=Math.max(f,+h.final)});let g=1/0;s.right&&l(r(s.right),h=>{g=Math.min(g,+h.final)}),f>=g&&l(r(s.right),h=>h.final+=f-g+d)},oe=s=>{let f=1/0;l(s,g=>f=Math.min(+g.final,f)),f<0&&l(s,g=>g.final-=f)},ae=s=>{l(s,f=>f.x=f.final)},U=s=>{if(s.left&&U(r(s.left)),s.right&&U(r(s.right)),s.left&&s.right){const f=+e[s.left].final,g=+e[s.right].final;s.final=(f+g)/2,i&&(s.final=Math.round(s.final))}else if(s.left){const f=e[s.left].final;f!==s.final&&(s.final=f)}else if(s.right){const f=e[s.right].final;f!==s.final&&(s.final=f)}};return c(n,0,null),v(n),I(n,0),oe(n),(N(n)||J(n))&&(W(n),U(n)),ae(n),e}const lr={props:["fromX","fromY","toX","toY","stroke","radius","text"],computed:{isRight(){return this.toX>this.fromX},padding(){return this.stroke*2},left(){return(this.fromX<this.toX?this.fromX:this.toX)-this.padding},top(){return(this.fromY<this.toY?this.fromY:this.toY)-this.padding},width(){return Math.abs(this.fromX-this.toX)+this.padding*2},height(){return Math.abs(this.fromY-this.toY)+this.padding*2},viewBox(){return`0 0 ${this.width} ${this.height}`},x1(){return this.fromX<this.toX?this.padding:this.width-this.padding},y1(){return this.fromY<this.toY?this.padding:this.height-this.padding},x2(){return this.fromX<this.toX?this.width-this.padding:this.padding},y2(){return this.fromY<this.toY?this.height-this.padding:this.padding},startingPoint(){return{x:this.fromX<this.toX?this.padding:this.width-this.padding,y:this.fromY<this.toY?this.padding:this.height-this.padding}},textPoint(){const e=Math.min((this.width-this.radius)/2,64);return{x:this.fromX<this.toX?this.padding+e:this.width-this.padding-e,y:this.startingPoint.y+this.height/2-this.padding}},endingPoint(){return{x:this.fromX<this.toX?this.width-this.padding:this.padding,y:this.fromY<this.toY?this.height-this.padding:this.padding}},firstJunction(){return{x:this.startingPoint.x,y:this.startingPoint.y+this.height/2-this.padding}},secondJunction(){return{x:this.fromX<this.toX?this.endingPoint.x-this.padding:this.endingPoint.x+this.padding,y:this.startingPoint.y+this.height/2-this.padding}},thirdJunction(){return{x:this.endingPoint.x,y:this.startingPoint.y+this.height/2-this.padding+ +this.radius}},style(){return{position:"absolute",left:`${this.left}px`,top:`${this.top}px`,zIndex:10}}}},dr=e=>(H("data-v-096ede22"),e=e(),S(),e),fr=["width","height","viewBox"],ur=["x1","y1","x2","y2","stroke-width"],hr=["x1","y1","x2","y2","stroke-width"],cr=["d","stroke-width"],pr=["x1","y1","x2","y2","stroke-width"],yr=dr(()=>o("marker",{id:"triangle",viewBox:"0 0 10 10",refX:"10",refY:"5",markerUnits:"strokeWidth",markerHeight:"4",orient:"auto",fill:"#0093ff"},[o("path",{d:"M 0 0 L 10 5 L 0 10 z"})],-1)),gr=["cx","cy","r"],mr=["cx","cy","r"];function vr(e,t,i,d,n,r){return u(),p(w,null,[(u(),p("svg",{class:"connector",xmlns:"http://www.w3.org/2000/svg",width:r.width,height:r.height,viewBox:r.viewBox,style:A(r.style)},[o("line",{x1:r.startingPoint.x,y1:r.startingPoint.y,x2:r.firstJunction.x,y2:r.firstJunction.y,stroke:"#0093ff","stroke-width":i.stroke},null,8,ur),o("line",{x1:r.firstJunction.x,y1:r.firstJunction.y,x2:r.secondJunction.x,y2:r.secondJunction.y,stroke:"#0093ff","stroke-width":i.stroke,"stroke-linecap":"round"},null,8,hr),o("path",{d:`
      M ${r.secondJunction.x} ${r.secondJunction.y} 
      C ${r.secondJunction.x+(r.isRight?+i.radius:-i.radius)} ${r.secondJunction.y}  
        ${r.thirdJunction.x} ${r.thirdJunction.y}  
        ${r.thirdJunction.x} ${r.thirdJunction.y}
      `,stroke:"#0093ff","stroke-width":i.stroke,"stroke-linecap":"round"},null,8,cr),o("line",{x1:r.thirdJunction.x,y1:r.thirdJunction.y,x2:r.endingPoint.x,y2:r.endingPoint.y,stroke:"#0093ff ","stroke-width":i.stroke,"stroke-linecap":"round","marker-end":"url(#triangle)"},null,8,pr),yr,o("circle",{cx:r.x1,cy:r.y1,r:i.stroke,stroke:"#0093ff",fill:"white","stroke-width":"2"},null,8,gr),o("circle",{cx:r.x2,cy:r.y2,r:i.stroke,stroke:"#0093ff",fill:"white","stroke-width":"2"},null,8,mr)],12,fr)),o("div",{class:"tag primary-text",style:A({left:`${this.left+r.textPoint.x-32}px`,top:`${this.top+r.textPoint.y-16}px`})},B(i.text),5)],64)}var kr=_(lr,[["render",vr],["__scopeId","data-v-096ede22"]]);const _r={extends:X,components:{SideConnector:kr},computed:{bothChildren(){return this.children.length===2},singleChild(){return this.children.length===1},centralConnectionPoint(){return{x:this.x+this.width/2,y:this.y+this.height}},leftConnectionPoint(){return{x:this.x,y:this.y+this.height/2}},rightConnectionPoint(){return{x:this.x+this.width,y:this.y+this.height/2}},singleChildConnection(){if(this.leftConnection)return this.leftConnection;if(this.rightConnection)return this.rightConnection}}},xr={class:"icon"},Cr=["src"],wr={class:"content"},br={class:"desc"},Hr=["innerHTML"];function Sr(e,t,i,d,n,r){const l=x("SideConnector"),a=x("LineConnector");return u(),p(w,null,[o("div",{class:m(["generic-node",{"drag-over":e.dragOver,rejected:e.rejected}]),style:A(e.nodeStyle),draggable:"true",onDragstart:t[0]||(t[0]=(...c)=>e.startDrag&&e.startDrag(...c)),onDragend:t[1]||(t[1]=(...c)=>e.dragEnd&&e.dragEnd(...c)),onDragover:t[2]||(t[2]=y(()=>{},["prevent"])),onDragenter:t[3]||(t[3]=y((...c)=>e.dragenter&&e.dragenter(...c),["prevent"])),onDragleave:t[4]||(t[4]=y((...c)=>e.dragleave&&e.dragleave(...c),["prevent"])),onDrop:t[5]||(t[5]=y((...c)=>e.drop&&e.drop(...c),["stop"])),onClick:t[6]||(t[6]=y((...c)=>e.click&&e.click(...c),["stop"])),onMousedown:t[7]||(t[7]=y(()=>{},["stop"]))},[o("div",xr,[o("img",{src:e.icons[e.type]},null,8,Cr)]),o("div",wr,[o("div",br,B(e.type.toUpperCase()),1),o("div",{class:"text",innerHTML:e.text},null,8,Hr)])],38),r.bothChildren?(u(),p(w,{key:0},[e.leftConnection?(u(),D(l,{key:0,fromX:r.centralConnectionPoint.x,fromY:r.centralConnectionPoint.y,toX:e.leftConnection.x,toY:e.leftConnection.y,text:"Yes",stroke:"4",radius:"6"},null,8,["fromX","fromY","toX","toY"])):O("",!0),e.rightConnection?(u(),D(l,{key:1,fromX:r.centralConnectionPoint.x,fromY:r.centralConnectionPoint.y,toX:e.rightConnection.x,toY:e.rightConnection.y,text:"No",stroke:"4",radius:"6"},null,8,["fromX","fromY","toX","toY"])):O("",!0)],64)):r.singleChild?(u(),D(a,{key:1,fromX:r.centralConnectionPoint.x,fromY:r.centralConnectionPoint.y,toX:r.singleChildConnection.x,toY:r.singleChildConnection.y,text:"X3",stroke:"4"},null,8,["fromX","fromY","toX","toY"])):O("",!0)],64)}var ee=_(_r,[["render",Sr]]),Vr="/card-dragger/assets/plus.866a2ef1.svg";const Mr={extends:X,computed:{plus(){return Vr},size(){return this.height/2},terminatorStyle(){if(this.absolute)return{position:"absolute",left:`${this.x+(this.width-this.size)/2}px`,top:`${this.y}px`,width:`${this.size}px`,height:`${this.size}px`}}},methods:{drop(e){this.dragOver=!1;const t=e.dataTransfer.getData("id"),i=this.parent,d=["stop-left","stop"].includes(this.type);this.$emit("dropOn",{from:t,to:i,left:d})}}},Ar=["src"];function Dr(e,t,i,d,n,r){return u(),p("div",{class:m(["generic-node end-node",{"drag-over":e.dragOver,rejected:e.rejected}]),style:A(r.terminatorStyle),onClick:t[5]||(t[5]=y((...l)=>e.click&&e.click(...l),["stop"])),onMousedown:t[6]||(t[6]=y(()=>{},["stop"]))},[o("div",{class:"dropzone",onDrop:t[0]||(t[0]=y((...l)=>r.drop&&r.drop(...l),["stop"])),onDragend:t[1]||(t[1]=(...l)=>e.dragEnd&&e.dragEnd(...l)),onDragover:t[2]||(t[2]=y(()=>{},["prevent"])),onDragenter:t[3]||(t[3]=y((...l)=>e.dragenter&&e.dragenter(...l),["prevent"])),onDragleave:t[4]||(t[4]=y((...l)=>e.dragleave&&e.dragleave(...l),["prevent"]))},null,32),o("img",{src:r.plus,class:"icon"},null,8,Ar)],38)}var te=_(Mr,[["render",Dr],["__scopeId","data-v-ba63501a"]]);const Lr={props:{zoomableIn:{type:Boolean},zoomableOut:{type:Boolean}}},re=e=>(H("data-v-0c308117"),e=e(),S(),e),Pr={class:"zoom-controls"},Ir=re(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1)),Or=[Ir],Xr=re(()=>o("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M19,13H5V11H19V13Z"})],-1)),Yr=[Xr];function Br(e,t,i,d,n,r){return u(),p("div",Pr,[o("div",{class:m(["control top",{disabled:!i.zoomableIn}]),onClick:t[0]||(t[0]=l=>e.$emit("zoom","zoomIn"))},Or,2),o("div",{class:m(["control bottom",{disabled:!i.zoomableOut}]),onClick:t[1]||(t[1]=l=>e.$emit("zoom","zoomOut"))},Yr,2)])}var zr=_(Lr,[["render",Br],["__scopeId","data-v-0c308117"]]);const Tr=320,Zr=180,Er=300,jr=100,Nr={components:{BaseNode:X,ForkNode:ee,TerminatorNode:te,ZoomControl:zr},props:{scene:{type:Object,required:!0},rejected:{type:Object,required:!0},zoom:{type:Number,default:1},zoomableIn:{type:Boolean},zoomableOut:{type:Boolean}},data(){return{dragging:null}},computed:{root(){return Object.values(this.scene).find(e=>!e.parent)},tree(){var e,t;return ar(this.scene,(t=(e=this.root)==null?void 0:e.id)!=null?t:0)},nodeWidth(){return Er},nodeHeight(){return jr},sceneStepX(){return Tr},sceneStepY(){return Zr},sceneMaxWidth(){const e=Object.values(this.tree).reduce((t,i)=>i.x>t?i.x:t,-1/0);return this.gridToCanvasX(e+1)},sceneMaxHeight(){const e=Object.values(this.tree).reduce((t,i)=>i.y>t?i.y:t,-1/0);return this.gridToCanvasY(e+1)},canvasStyle(){return{minWidth:`${this.sceneMaxWidth*this.zoom}px`,minHeight:`${this.sceneMaxHeight*this.zoom}px`,transform:`scale(${this.zoom})`}}},watch:{zoom(e,t){if(e!==t){const{width:i,height:d}=this.$refs.scroller.getBoundingClientRect(),{scrollLeft:n,scrollTop:r}=this.$refs.scroller,l=e/t,a=n+i/2,c=r+d/2,v=a*l,I=c*l,N=v-i/2,J=I-d/2;this.$refs.scroller.scrollLeft=N,this.$refs.scroller.scrollTop=J}},scene(e,t){const{id:i=null}=Object.values(t).find(n=>!n.parent),{id:d=null}=Object.values(e).find(n=>!n.parent);i!==d&&this.$nextTick(()=>{const n=this.tree[d],r=this.gridToCanvasX(n.x),{width:l}=this.$refs.scroller.getBoundingClientRect();this.$refs.scroller.scrollTop=0,this.$refs.scroller.scrollLeft=(r-l/2+this.nodeWidth/2)*this.zoom})}},methods:{gridToCanvasX(e){return e*this.sceneStepX},gridToCanvasY(e){return e*this.sceneStepY},connectionPoint(e){const t=this.tree[e];if(t)return{x:t.x*this.sceneStepX+this.nodeWidth/2,y:t.y*this.sceneStepY}},getComponent(e){return e.type==="fork"?ee:["stop","stop-left","stop-right"].includes(e.type)?te:X},nodeClick(e){this.$emit("select",e)},mouseStartScroll(e){e.buttons===1&&(this.dragging={x:e.pageX,y:e.pageY,initialScrollLeft:this.$refs.scroller.scrollLeft,initialScrollTop:this.$refs.scroller.scrollTop})},mouseStopScroll(){this.dragging=null},mouseScroll(e){if(this.dragging&&e.buttons===1){const t=this.dragging.x-e.pageX,i=this.dragging.y-e.pageY;this.$refs.scroller.scrollLeft=this.dragging.initialScrollLeft+t,this.$refs.scroller.scrollTop=this.dragging.initialScrollTop+i}},mouseZoom(e){e.ctrlKey&&(e.deltaY<0&&this.$emit("zoomIn"),e.deltaY>0&&this.$emit("zoomOut"),e.preventDefault())}}};function Jr(e,t,i,d,n,r){const l=x("ZoomControl");return u(),p("div",{class:m(["canvas-outer",{dragging:Boolean(n.dragging)}]),ref:"scroller",onMousedown:t[4]||(t[4]=(...a)=>r.mouseStartScroll&&r.mouseStartScroll(...a)),onMouseover:t[5]||(t[5]=(...a)=>r.mouseStartScroll&&r.mouseStartScroll(...a)),onMouseup:t[6]||(t[6]=(...a)=>r.mouseStopScroll&&r.mouseStopScroll(...a)),onMouseout:t[7]||(t[7]=(...a)=>r.mouseStopScroll&&r.mouseStopScroll(...a)),onMousemove:t[8]||(t[8]=(...a)=>r.mouseScroll&&r.mouseScroll(...a)),onWheel:t[9]||(t[9]=(...a)=>r.mouseZoom&&r.mouseZoom(...a)),onClick:t[10]||(t[10]=y(a=>r.nodeClick(null),["stop"]))},[o("div",{class:"canvas-inner",style:A(r.canvasStyle),ref:"canvas",onDragover:t[1]||(t[1]=y(()=>{},["prevent"])),onDragenter:t[2]||(t[2]=y(()=>{},["prevent"]))},[(u(!0),p(w,null,E(r.tree,a=>(u(),D(ce(r.getComponent(a)),{key:a.id,parent:a.parent,id:a.id,x:r.gridToCanvasX(a.x),y:r.gridToCanvasY(a.y),absolute:!0,rejected:Boolean(i.rejected[a.id]),width:r.nodeWidth,height:r.nodeHeight,type:a.type,text:a.text,leftConnection:r.connectionPoint(a.left),rightConnection:r.connectionPoint(a.right),onDropOn:t[0]||(t[0]=c=>e.$emit("dropNode",c)),onClick:c=>r.nodeClick(a.id)},null,8,["parent","id","x","y","rejected","width","height","type","text","leftConnection","rightConnection","onClick"]))),128))],36),b(l,{zoomableIn:i.zoomableIn,zoomableOut:i.zoomableOut,onZoom:t[3]||(t[3]=a=>e.$emit(a))},null,8,["zoomableIn","zoomableOut"])],34)}var Wr=_(Nr,[["render",Jr]]);function j(e){return{states:[e],position:1}}function Ur(e,t){const i=[...e.states.slice(0,e.position),t],d=i.length;return M(V({},e),{states:i,position:d})}function Gr({states:e,position:t}){return e[t-1]}function ie({position:e}){return e>1}function ne({states:e,position:t}){return t<e.length}function Rr(e){if(!ie(e))throw new Error("Can't undo!");return M(V({},e),{position:e.position-1})}function Fr(e){if(!ne(e))throw new Error("Can't redo!");return M(V({},e),{position:e.position+1})}function F(e){switch(e){case"email":return"Email subject";case"delay":return"Delay duration";case"fork":return"Fork condition";case"flash":return"Workflow desciption"}}var Kr=[{id:"oPRR_Zfc49cD4QGptBOPk",parent:null,type:"flash",left:null},{type:"email",fork:!1,id:"EwhrQEVOiikiZ-P8MQFxV",parent:"oPRR_Zfc49cD4QGptBOPk",left:!0},{type:"delay",fork:!1,id:"8xU5U5__V_3csDXplazw-",parent:"EwhrQEVOiikiZ-P8MQFxV",left:!0},{type:"fork",fork:!0,id:"wt7ufIQHJ-vaC3Vfyw5Iy",parent:"8xU5U5__V_3csDXplazw-",left:!0},{type:"delay",fork:!1,id:"F5T4GtIwsKkdE-z6ig5PU",parent:"wt7ufIQHJ-vaC3Vfyw5Iy",left:!0},{type:"email",fork:!1,id:"mEd0tRYy2ybAt2Vbd0GNF",parent:"F5T4GtIwsKkdE-z6ig5PU",left:!0},{type:"delay",fork:!1,id:"bzKbAlLc-C6WIledLGXiM",parent:"mEd0tRYy2ybAt2Vbd0GNF",left:!0},{type:"email",fork:!1,id:"jZPIDm4bD0MnJuyCjieXD",parent:"bzKbAlLc-C6WIledLGXiM",left:!0},{type:"delay",fork:!1,id:"l87tluQ0JWS1I-gFdcN3w",parent:"jZPIDm4bD0MnJuyCjieXD",left:!0},{type:"email",fork:!1,id:"uuFVj4p9hACyY-BCIFfkl",parent:"l87tluQ0JWS1I-gFdcN3w",left:!0},{type:"delay",fork:!1,id:"fb8ZX1on_HYcZLbnR0C7-",parent:"uuFVj4p9hACyY-BCIFfkl",left:!0},{type:"email",fork:!1,id:"xiUlPsSxDAsRmXOCOd1YE",parent:"fb8ZX1on_HYcZLbnR0C7-",left:!0},{type:"delay",fork:!1,id:"Y8CbjFQORrc2SiELwmq8q",parent:"xiUlPsSxDAsRmXOCOd1YE",left:!0},{type:"email",fork:!1,id:"QpnhkPN3tMPX1oLgswdUc",parent:"Y8CbjFQORrc2SiELwmq8q",left:!0},{type:"fork",fork:!0,id:"jYGcMD7thEbkmwZvnQDeI",parent:"QpnhkPN3tMPX1oLgswdUc",left:!0},{type:"delay",fork:!1,id:"lsTHafE52DUK_V33nyDUv",parent:"jYGcMD7thEbkmwZvnQDeI",left:!0},{type:"email",fork:!1,id:"IuioqG6Zwx5HZCBeab_2c",parent:"lsTHafE52DUK_V33nyDUv",left:!0},{type:"delay",fork:!1,id:"IrhwC9W7d6nxUd4I80Ott",parent:"IuioqG6Zwx5HZCBeab_2c",left:!0},{type:"delay",fork:!1,id:"Au82rlMMvHEyxpYIkTRLs",parent:"jYGcMD7thEbkmwZvnQDeI",left:!1},{type:"email",fork:!1,id:"eTFr3MFxlrGcr9fV4ms0i",parent:"Au82rlMMvHEyxpYIkTRLs",left:!0},{type:"delay",fork:!1,id:"VrR5Hv4ZyxORjnvwk0uk9",parent:"eTFr3MFxlrGcr9fV4ms0i",left:!0},{type:"fork",fork:!0,id:"iVFIwiTuh_8TSoYm-y9HH",parent:"VrR5Hv4ZyxORjnvwk0uk9",left:!0},{type:"email",fork:!1,id:"fLLgnOqEHDWPut5g-2kqO",parent:"iVFIwiTuh_8TSoYm-y9HH",left:!1},{type:"delay",fork:!1,id:"PlyFI0bGBkHfUEJXZuycu",parent:"fLLgnOqEHDWPut5g-2kqO",left:!0},{type:"fork",fork:!0,id:"ltLLfFYgrn4YK1BPQ1kiN",parent:"PlyFI0bGBkHfUEJXZuycu",left:!0},{type:"email",fork:!1,id:"BR_YffXNWr-4DZEqPO1ip",parent:"ltLLfFYgrn4YK1BPQ1kiN",left:!1},{type:"delay",fork:!1,id:"uYpCm2vYPCivAxqKYVRGo",parent:"wt7ufIQHJ-vaC3Vfyw5Iy",left:!1},{type:"email",fork:!1,id:"tBixA7flUa6Kup-zXdig9",parent:"uYpCm2vYPCivAxqKYVRGo",left:!0},{type:"delay",fork:!1,id:"GcFsjDrUIPnKhnpBkSpTt",parent:"tBixA7flUa6Kup-zXdig9",left:!0},{type:"fork",fork:!0,id:"mdAfWuBd6t8WPusK5wNEh",parent:"GcFsjDrUIPnKhnpBkSpTt",left:!0},{type:"email",fork:!1,id:"FvQdtPgV0bPHX03K7_XzO",parent:"mdAfWuBd6t8WPusK5wNEh",left:!1},{type:"delay",fork:!1,id:"qDq8K7ok1Ey2p3f8hl4p2",parent:"FvQdtPgV0bPHX03K7_XzO",left:!0},{type:"fork",fork:!0,id:"mOmt4je5vB2t5ppQZxTs3",parent:"qDq8K7ok1Ey2p3f8hl4p2",left:!0},{type:"email",fork:!1,id:"JYXHvKH3eMgXHfW1f90IO",parent:"mOmt4je5vB2t5ppQZxTs3",left:!1},{type:"delay",fork:!1,id:"OAZhsxIg_wnMUAvyBcF3k",parent:"JYXHvKH3eMgXHfW1f90IO",left:!0},{type:"fork",fork:!0,id:"DVsMnWbtWQZ4eFs33oi48",parent:"OAZhsxIg_wnMUAvyBcF3k",left:!0},{type:"email",fork:!1,id:"e3oaBWyF56DNmm-8bd0D_",parent:"DVsMnWbtWQZ4eFs33oi48",left:!1},{type:"delay",fork:!1,id:"o8IZ9LY_W3nGIPntxt12P",parent:"e3oaBWyF56DNmm-8bd0D_",left:!0},{type:"fork",fork:!0,id:"njcfQneHwGGEsZlmeT_tm",parent:"o8IZ9LY_W3nGIPntxt12P",left:!0},{type:"email",fork:!1,id:"zhElTMugjYDlU_4sT6Hg2",parent:"njcfQneHwGGEsZlmeT_tm",left:!1},{type:"delay",fork:!1,id:"dyaPuwkIINRbq_utuf-Pg",parent:"zhElTMugjYDlU_4sT6Hg2",left:!0},{type:"fork",fork:!0,id:"e7pHLtP21c0j9q9EPPLek",parent:"dyaPuwkIINRbq_utuf-Pg",left:!0},{type:"email",fork:!1,id:"mOYi9wK7RhsoLNQVh0f5y",parent:"e7pHLtP21c0j9q9EPPLek",left:!1}],Qr=[{id:"lMEpqKaSWYzFk2rKOYd-m",parent:null,type:"flash",left:null},{type:"fork",fork:!0,id:"2Ay-kBMCZPj5wKlm_z0XN",parent:"lMEpqKaSWYzFk2rKOYd-m",left:!0},{type:"email",fork:!1,id:"5pSJeDaXDZq3UFifbq3Ba",parent:"2Ay-kBMCZPj5wKlm_z0XN",left:!0},{type:"delay",fork:!1,id:"SPoWR6nZhmRaJw5A-59Fo",parent:"5pSJeDaXDZq3UFifbq3Ba",left:!0},{type:"fork",fork:!0,id:"LAhOqOlzDB1YQ5gEO6eAk",parent:"SPoWR6nZhmRaJw5A-59Fo",left:!0},{type:"email",fork:!1,id:"WpyzRwRl4MBy8Wg5tUYEW",parent:"LAhOqOlzDB1YQ5gEO6eAk",left:!0},{type:"delay",fork:!1,id:"3HYAnneofqSalpJKHikcn",parent:"WpyzRwRl4MBy8Wg5tUYEW",left:!0},{type:"email",fork:!1,id:"Th_6LvtE50GGZ6lTz9AwU",parent:"3HYAnneofqSalpJKHikcn",left:!0},{type:"email",fork:!1,id:"xEInW2txTC_PGyQ9UxVkr",parent:"LAhOqOlzDB1YQ5gEO6eAk",left:!1},{type:"delay",fork:!1,id:"yochrzV6YvwrqMmX1x3LE",parent:"xEInW2txTC_PGyQ9UxVkr",left:!0},{type:"fork",fork:!0,id:"sAEKa9kVrtzCH7dfvJVL8",parent:"yochrzV6YvwrqMmX1x3LE",left:!0},{type:"email",fork:!1,id:"Ya44q-T73De3ACoHSRTjS",parent:"sAEKa9kVrtzCH7dfvJVL8",left:!1},{type:"delay",fork:!1,id:"Hccpf6aXebhMpd7yWHtag",parent:"Ya44q-T73De3ACoHSRTjS",left:!0},{type:"fork",fork:!0,id:"guM42dz-qFNTHBeEHj0gz",parent:"Hccpf6aXebhMpd7yWHtag",left:!0},{type:"email",fork:!1,id:"3IbUbFhPFSmUZgAs4fync",parent:"guM42dz-qFNTHBeEHj0gz",left:!1},{type:"email",fork:!1,id:"P29FJj6l3rpX7PBPH5xZW",parent:"2Ay-kBMCZPj5wKlm_z0XN",left:!1},{type:"delay",fork:!1,id:"NiuBj_PyKc12nDKaMQfJr",parent:"P29FJj6l3rpX7PBPH5xZW",left:!0},{type:"fork",fork:!0,id:"LQS5oMJ92XwpYiYVHd6pQ",parent:"NiuBj_PyKc12nDKaMQfJr",left:!0},{type:"email",fork:!1,id:"5abxFOzwyK2Ddn29AXBY_",parent:"LQS5oMJ92XwpYiYVHd6pQ",left:!0},{type:"delay",fork:!1,id:"L2gQaOD9eunRmcrM2GOOu",parent:"5abxFOzwyK2Ddn29AXBY_",left:!0},{type:"email",fork:!1,id:"ZDWDnsG-hZKH8HLaQvtfW",parent:"L2gQaOD9eunRmcrM2GOOu",left:!0},{type:"email",fork:!1,id:"oaEtyMTM8t62y6bUd7pFu",parent:"LQS5oMJ92XwpYiYVHd6pQ",left:!1},{type:"delay",fork:!1,id:"j6UL9gvHiRdC3Zopzr6Cs",parent:"oaEtyMTM8t62y6bUd7pFu",left:!0},{type:"fork",fork:!0,id:"4Dy0rQiJ6S1_EpzwCQuJE",parent:"j6UL9gvHiRdC3Zopzr6Cs",left:!0},{type:"email",fork:!1,id:"j00cM1XQmCXG9gBGJzFgy",parent:"4Dy0rQiJ6S1_EpzwCQuJE",left:!1},{type:"delay",fork:!1,id:"rNFPVUzZmUsAQsZtyvvh9",parent:"j00cM1XQmCXG9gBGJzFgy",left:!0},{type:"fork",fork:!0,id:"IksLREAq1blLJv6e2KQEk",parent:"rNFPVUzZmUsAQsZtyvvh9",left:!0},{type:"email",fork:!1,id:"fsK6ZMSNI9iYX_YvbME_w",parent:"IksLREAq1blLJv6e2KQEk",left:!1}],qr=[{id:"-Oua7T27qK_BtzgzgdM6c",parent:null,type:"flash",left:null},{type:"email",fork:!1,id:"yiizcrPOYmmhwfPjcZw9n",parent:"-Oua7T27qK_BtzgzgdM6c",left:!0},{type:"fork",fork:!0,id:"1KIb7H-1HddSjVpMdWSBC",parent:"yiizcrPOYmmhwfPjcZw9n",left:!0},{type:"delay",fork:!1,id:"x2xy76MpD-2mxhL4JJJSo",parent:"1KIb7H-1HddSjVpMdWSBC",left:!0},{type:"email",fork:!1,id:"n715nmhZuMuxKIGzToMDM",parent:"x2xy76MpD-2mxhL4JJJSo",left:!0},{type:"delay",fork:!1,id:"WZkkjXVLuzRfSeOrWAxQW",parent:"1KIb7H-1HddSjVpMdWSBC",left:!1},{type:"email",fork:!1,id:"QTYnrKASZWKWZCBSTK2bM",parent:"WZkkjXVLuzRfSeOrWAxQW",left:!0},{type:"fork",fork:!0,id:"sSXGPvkxqti131dP3woXV",parent:"QTYnrKASZWKWZCBSTK2bM",left:!0},{type:"delay",fork:!1,id:"rvId96sXHgPgEXSetZGYG",parent:"sSXGPvkxqti131dP3woXV",left:!0},{type:"email",fork:!1,id:"fpyL0-t30Cy_xQZ6zK0lX",parent:"rvId96sXHgPgEXSetZGYG",left:!0},{type:"delay",fork:!1,id:"TO7TVsYBQV2D0JqsR-s5b",parent:"sSXGPvkxqti131dP3woXV",left:!1},{type:"email",fork:!1,id:"tvXBMmY961TSfRFmu0GhX",parent:"TO7TVsYBQV2D0JqsR-s5b",left:!0},{type:"fork",fork:!0,id:"q5o0KxiwJTHZ8OTmIct-W",parent:"tvXBMmY961TSfRFmu0GhX",left:!0},{type:"delay",fork:!1,id:"weBoZT_EArdCIfXTcspZC",parent:"q5o0KxiwJTHZ8OTmIct-W",left:!0},{type:"email",fork:!1,id:"YAYTTRDYao8vifoMtd55H",parent:"weBoZT_EArdCIfXTcspZC",left:!0},{type:"delay",fork:!1,id:"Q9SErsAFI535EbqO701tT",parent:"q5o0KxiwJTHZ8OTmIct-W",left:!1},{type:"email",fork:!1,id:"71gZxJaaFcU6OtlOqpk2I",parent:"Q9SErsAFI535EbqO701tT",left:!0},{type:"fork",fork:!0,id:"ECa_LZTg6_u5xXMmK96d6",parent:"71gZxJaaFcU6OtlOqpk2I",left:!0},{type:"delay",fork:!1,id:"qhDp6kZ8aDdSJ98gCFrGB",parent:"ECa_LZTg6_u5xXMmK96d6",left:!0},{type:"email",fork:!1,id:"n-TJWMztJpPvXXRbe-jyM",parent:"qhDp6kZ8aDdSJ98gCFrGB",left:!0},{type:"delay",fork:!1,id:"3RUFxK_0GJPsuqzHIrYa5",parent:"ECa_LZTg6_u5xXMmK96d6",left:!1},{type:"email",fork:!1,id:"l10tzHeAZMy_zUQa3Gxiu",parent:"3RUFxK_0GJPsuqzHIrYa5",left:!0},{type:"fork",fork:!0,id:"yvPgqnvNFJ7SoZi9ZlsJw",parent:"l10tzHeAZMy_zUQa3Gxiu",left:!0},{type:"delay",fork:!1,id:"jOzVmWy-eU5HpD_b_NCfY",parent:"yvPgqnvNFJ7SoZi9ZlsJw",left:!0},{type:"email",fork:!1,id:"j7vrc2BaaoJKIJM_FVOP0",parent:"jOzVmWy-eU5HpD_b_NCfY",left:!0},{type:"delay",fork:!1,id:"rzVd-se47XctfmuoPiJs3",parent:"yvPgqnvNFJ7SoZi9ZlsJw",left:!1},{type:"email",fork:!1,id:"J7RbBW5sKLciQemn82mg3",parent:"rzVd-se47XctfmuoPiJs3",left:!0},{type:"fork",fork:!0,id:"1tLB2JzfgHWh6rgmtROPY",parent:"J7RbBW5sKLciQemn82mg3",left:!0},{type:"delay",fork:!1,id:"6vh0SPzqRM-DtJU6il_le",parent:"1tLB2JzfgHWh6rgmtROPY",left:!0},{type:"email",fork:!1,id:"oSRADYg-aA9Ic2gF7zgc3",parent:"6vh0SPzqRM-DtJU6il_le",left:!0},{type:"delay",fork:!1,id:"wLfbnIMvL4twPJFmoANi3",parent:"1tLB2JzfgHWh6rgmtROPY",left:!1},{type:"email",fork:!1,id:"r7eNlouELNGwGoYbdnh_k",parent:"wLfbnIMvL4twPJFmoANi3",left:!0}],$r=[{id:"s0fyWOvvSw9AY__K1pff1",parent:null,type:"flash",left:null},{type:"delay",fork:!1,id:"8zG-kPPjVtGEPn6q-mLEr",parent:"s0fyWOvvSw9AY__K1pff1",left:!0},{type:"fork",fork:!0,id:"hZtljPZYwHD_3ukG63WS4",parent:"8zG-kPPjVtGEPn6q-mLEr",left:!0},{type:"fork",fork:!0,id:"3DwKmVAAe5Cds2R4H_c7D",parent:"hZtljPZYwHD_3ukG63WS4",left:!0},{type:"email",fork:!1,id:"0EjEELA_72MaLDDPDxjOD",parent:"3DwKmVAAe5Cds2R4H_c7D",left:!0},{type:"email",fork:!1,id:"rF1E7IKvDRvVXKuBCtTte",parent:"0EjEELA_72MaLDDPDxjOD",left:!0},{type:"delay",fork:!1,id:"QSyDwFBvtY63r-3-HVs-X",parent:"rF1E7IKvDRvVXKuBCtTte",left:!0},{type:"fork",fork:!0,id:"00GSMosmuGUjk0thW_bNx",parent:"QSyDwFBvtY63r-3-HVs-X",left:!0},{type:"fork",fork:!0,id:"ibpDAPQp9jBoC7mPiM2rO",parent:"00GSMosmuGUjk0thW_bNx",left:!0},{type:"email",fork:!1,id:"kZVEYcJuryWl5fuuqe9rk",parent:"ibpDAPQp9jBoC7mPiM2rO",left:!1},{type:"delay",fork:!1,id:"YGt-GAEXoax7UUl7YX-a7",parent:"ibpDAPQp9jBoC7mPiM2rO",left:!0},{type:"fork",fork:!0,id:"vrbiy8JfGphZvDdyIZrvV",parent:"YGt-GAEXoax7UUl7YX-a7",left:!0},{type:"fork",fork:!0,id:"8JWlzx86SVDO1McHDJh6G",parent:"vrbiy8JfGphZvDdyIZrvV",left:!0},{type:"email",fork:!1,id:"8UXF34AhJhgpiT_raS0xx",parent:"8JWlzx86SVDO1McHDJh6G",left:!1},{type:"email",fork:!1,id:"G-aNuQ94JFm-lNXFGWS3F",parent:"8JWlzx86SVDO1McHDJh6G",left:!0},{type:"fork",fork:!0,id:"SzVMkwYpIA2E67UuZOCCn",parent:"G-aNuQ94JFm-lNXFGWS3F",left:!0},{type:"email",fork:!1,id:"0ODLI5nNA4rHvOvQx_UIv",parent:"SzVMkwYpIA2E67UuZOCCn",left:!0},{type:"email",fork:!1,id:"S64VcQJHofoAlepdRRsSg",parent:"0ODLI5nNA4rHvOvQx_UIv",left:!0},{type:"email",fork:!1,id:"bO8H09G6raHmxWxTLPiA3",parent:"3DwKmVAAe5Cds2R4H_c7D",left:!1},{type:"delay",fork:!1,id:"5hiyy72_Brf_eR0zQHG4h",parent:"bO8H09G6raHmxWxTLPiA3",left:!0},{type:"fork",fork:!0,id:"kU5BaDwLWCZpns_SOFACa",parent:"5hiyy72_Brf_eR0zQHG4h",left:!0},{type:"fork",fork:!0,id:"g9WcoIvUSgjDoIpLJCAAa",parent:"kU5BaDwLWCZpns_SOFACa",left:!0},{type:"delay",fork:!1,id:"-ZIsryYjS-v1YoS_M3UOS",parent:"g9WcoIvUSgjDoIpLJCAAa",left:!0},{type:"fork",fork:!0,id:"UgJe3rD7RlZk7Zt8TURmB",parent:"-ZIsryYjS-v1YoS_M3UOS",left:!0},{type:"fork",fork:!0,id:"_oQVlDoxVy2MCO6fi1jHI",parent:"UgJe3rD7RlZk7Zt8TURmB",left:!0},{type:"email",fork:!1,id:"kHAbXLh_Kk8fsySoJ0dbo",parent:"_oQVlDoxVy2MCO6fi1jHI",left:!0},{type:"email",fork:!1,id:"IpmPGTTaOU6ptq_cRxGJh",parent:"_oQVlDoxVy2MCO6fi1jHI",left:!1}],ei=[{id:"rPZ6eoTwXV8VzIhM86Fx1",parent:null,type:"flash",left:null},{type:"email",fork:!1,id:"lKM14IIulf10_nhSrRK4L",parent:"rPZ6eoTwXV8VzIhM86Fx1",left:!0},{type:"fork",fork:!0,id:"Ia2aXLfrCUrNxwK378I-N",parent:"lKM14IIulf10_nhSrRK4L",left:!0},{type:"fork",fork:!0,id:"LfCR8Ig3Rc796W1NVPASL",parent:"Ia2aXLfrCUrNxwK378I-N",left:!0},{type:"delay",fork:!1,id:"rr0fGgdVwgPuaO2OPiWvF",parent:"LfCR8Ig3Rc796W1NVPASL",left:!0},{type:"email",fork:!1,id:"-RqeOiZ_nCIhuKs6zuEmy",parent:"rr0fGgdVwgPuaO2OPiWvF",left:!0},{type:"fork",fork:!0,id:"LhUErR8ChdD0pT9X5WD-9",parent:"-RqeOiZ_nCIhuKs6zuEmy",left:!0},{type:"fork",fork:!0,id:"ZkkoZMexYfIUCZJ2rLV3o",parent:"LhUErR8ChdD0pT9X5WD-9",left:!0},{type:"fork",fork:!0,id:"b2kGZPir-XbXsAsce4pp_",parent:"ZkkoZMexYfIUCZJ2rLV3o",left:!0},{type:"delay",fork:!1,id:"2teHL3c1slCu1iGC7FhEB",parent:"b2kGZPir-XbXsAsce4pp_",left:!0},{type:"email",fork:!1,id:"xEQI2PIHb3hUG42ne6L-Z",parent:"2teHL3c1slCu1iGC7FhEB",left:!0},{type:"fork",fork:!0,id:"f-dYwQDbBIUokNtnh77Gi",parent:"xEQI2PIHb3hUG42ne6L-Z",left:!0},{type:"fork",fork:!0,id:"Gk7Awyg9rjoXHgYRxxeXu",parent:"f-dYwQDbBIUokNtnh77Gi",left:!0},{type:"delay",fork:!1,id:"EI4rI8-Ws3xnW8ogM1z5q",parent:"Gk7Awyg9rjoXHgYRxxeXu",left:!0},{type:"email",fork:!1,id:"9y_7pOr8B1tKafaSm3enV",parent:"EI4rI8-Ws3xnW8ogM1z5q",left:!0},{type:"fork",fork:!0,id:"KgBuNhTWdeLUY9pc5xb1H",parent:"9y_7pOr8B1tKafaSm3enV",left:!0},{type:"fork",fork:!0,id:"givEYKBh2P-ODM9dE-0AT",parent:"KgBuNhTWdeLUY9pc5xb1H",left:!0},{type:"delay",fork:!1,id:"6zJOPQOcOAsbajNmnHm8W",parent:"givEYKBh2P-ODM9dE-0AT",left:!0},{type:"email",fork:!1,id:"kMbrw08G_BPv59UE60RT2",parent:"6zJOPQOcOAsbajNmnHm8W",left:!0}];function T(e){return e.map(t=>t.text?t:M(V({},t),{text:F(t.type)}))}var se=[{id:k(),name:"Welcome series",data:T(Kr)},{id:k(),name:"Post-purchase series",data:T(Qr)},{id:k(),name:"Retention series",data:T(qr)},{id:k(),name:"Winback series",data:T($r)},{id:k(),name:"Abandoned series",data:T(ei)}];const C=require("./utils/tree"),ti={components:{Layout:Se,Sidebar:It,Header:or,Canvas:Wr},data(){return{history:null,rejected:{},zoom:1,selectedNode:null,savingStatus:""}},computed:{scene(){return this.history?Gr(this.history):[]},widerScene(){const e=C.clone(this.scene);return Object.keys(e).reduce((t,i)=>{const d=e[i];if(t[i]=d,!d.left){const n={id:k(),parent:d.id,type:"stop-left"};d.left=n.id,t[n.id]=n}if(d.type==="fork"&&!d.right){const n={id:k(),parent:d.id,type:"stop-right"};d.right=n.id,t[n.id]=n}return t},{})},undoable(){return Boolean(this.history&&ie(this.history))},redoable(){return Boolean(this.history&&ne(this.history))},zoomableIn(){return this.zoom<1},zoomableOut(){return this.zoom>.3},hasUnsavedChanges(){return this.undoable},availableTypes(){return["delay","email","fork"].map(e=>({type:e,id:k()}))},samples(){return se.map(({id:e,name:t})=>({id:e,name:t}))},initialScene(){return[{id:k(),parent:null,left:null,type:"flash",text:F("flash")}]}},created(){const e=k(),t=k(),i=k(),d=k(),n=k(),r=[{id:e,type:"flash",left:null},{id:t,parent:e,type:"email",left:!0},{id:i,parent:t,type:"fork",fork:!0,left:!0},{id:d,parent:i,type:"headset",left:!0},{id:n,parent:i,type:"account",left:!1}];this.history=j(C.load(r)),this.backgroundSaver=pe(()=>this.save(),1e3)},mounted(){try{this.load()}catch(e){console.error(e),this.erase()}this.savingStatus="Saved",this.keyHandler=e=>{const t=e.code==="KeyZ"&&e.ctrlKey||e.code==="Backspace"&&e.ctrlKey,i=e.code==="KeyY"&&e.ctrlKey;t&&this.undoable&&(this.undo(),e.stopPropagation()),i&&this.redoable&&(this.redo(),e.stopPropagation())},document.addEventListener("keydown",this.keyHandler)},beforeDestroy(){document.removeEventListener("keydown",this.keyHandler),this.backgroundSaver.cancel()},methods:{save(){const e=C.pack(this.scene);localStorage.savedScene=JSON.stringify(e),this.savingStatus="autosaved"},load(){try{const e=JSON.parse(localStorage.savedScene||"0");Array.isArray(e)&&(this.history=j(C.load(e)))}catch(e){console.error(e),this.erase()}},loadSample(e){try{const t=se.find(d=>d.id===e),i=C.load(t.data);this.history=j(i)}catch(t){console.error(t),this.erase()}},updateScene(e){this.history=Ur(this.history,e),this.savingStatus="",this.backgroundSaver()},undo(){this.history=Rr(this.history),this.savingStatus="",this.backgroundSaver()},redo(){this.history=Fr(this.history),this.savingStatus="",this.backgroundSaver()},erase(){this.history=j(C.load(this.initialScene))},zoomIn(){this.zoom=Math.min(this.zoom+.1,1)},zoomOut(){this.zoom=Math.max(this.zoom-.1,.3)},dropNode({from:e,to:t,left:i=null}){const d=this.scene[t];if(!d){this.reject(e),this.reject(t);return}const n=this.availableTypes.find(l=>l.id===e);if(n)return this.attachNewNode(n,d,i);const r=this.scene[e];return r?this.moveNode(r,d,i):this.reject(e)},dropOff(e){const t=e.dataTransfer.getData("id");this.reject(t)},addNode(e,t){const i=this.availableTypes.find(d=>d.id===e);i&&(this.attachNewNode(i,this.selectedNode,t),this.selectedNode=null)},updateNode(e,t){const i=C.clone(this.scene);i[e]=t,this.updateScene(i)},attachNewNode(e,t,i=null){const d=M(V({},e),{fork:e.type==="fork",text:F(e.type),id:k()});try{const n=C.insert(this.scene,t.id,d.id,i,C.payload(d));this.updateScene(n)}catch(n){return console.error(n),this.reject(t.id)}},moveNode(e,t,i=null){try{if(e.fork){const d=C.moveSubtree(this.scene,t.id,e.id,i);this.updateScene(d)}else{const d=C.moveNode(this.scene,t.id,e.id,i);this.updateScene(d)}}catch(d){console.error(d),this.reject(t.id),this.reject(e.id)}},deleteNode(e){try{const t=this.scene[e];if(!t)throw new Error("Not scene item");if(t.fork&&(t.left||t.right))throw new Error("Can't remove fork node with children");const i=C.removeNode(this.scene,e);this.updateScene(i),this.selectedNode=null}catch(t){console.error(t),this.reject("trash"),this.reject(e);return}},selectNode(e){this.selectedNode=this.scene[e]},reject(e){this.rejected[e]=!0,setTimeout(()=>{this.rejected[e]=!1},1e3)}}};function ri(e,t,i,d,n,r){const l=x("Sidebar"),a=x("Header"),c=x("Canvas"),v=x("Layout");return u(),D(v,null,{sidebar:z(()=>[b(l,{nodes:r.availableTypes,rejected:n.rejected,selected:n.selectedNode,onDelete:r.deleteNode,onAdd:r.addNode,onUpdate:r.updateNode,onUnselect:t[0]||(t[0]=I=>n.selectedNode=null)},null,8,["nodes","rejected","selected","onDelete","onAdd","onUpdate"])]),header:z(()=>[b(a,{undoable:r.undoable,redoable:r.redoable,samples:r.samples,status:n.savingStatus,onUndo:r.undo,onRedo:r.redo,onErase:r.erase,onSelect:r.loadSample},null,8,["undoable","redoable","samples","status","onUndo","onRedo","onErase","onSelect"])]),default:z(()=>[b(c,{scene:r.widerScene,rejected:n.rejected,zoom:n.zoom,zoomableIn:r.zoomableIn,zoomableOut:r.zoomableOut,onUpdate:r.updateScene,onDropNode:r.dropNode,onDrop:r.dropOff,onZoomIn:r.zoomIn,onZoomOut:r.zoomOut,onSelect:r.selectNode},null,8,["scene","rejected","zoom","zoomableIn","zoomableOut","onUpdate","onDropNode","onDrop","onZoomIn","onZoomOut","onSelect"])]),_:1})}var ii=_(ti,[["render",ri]]);ye(ii).mount("#app");
